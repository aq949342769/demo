<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>课程进度跟踪</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF', // 计划进度蓝色
            secondary: '#00B42A', // 实际进度绿色
            neutral: {
              100: '#F5F7FA',
              200: '#E4E7ED',
              300: '#C0C6CF',
              400: '#909399',
              500: '#606266',
              600: '#303133',
            }
          },
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
        },
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .progress-animation {
        transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1);
      }
      .card-shadow {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }
      .btn-hover {
        transition: all 0.3s ease;
      }
      .btn-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(22, 93, 255, 0.25);
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    }
  </style>
</head>

<body class="font-inter bg-neutral-100 text-neutral-600 min-h-screen flex flex-col">
<!-- 顶部导航 -->
<header class="bg-white shadow-sm sticky top-0 z-50">
  <div class="container mx-auto px-4 py-3 flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <i class="fa fa-graduation-cap text-primary text-xl"></i>
      <h1 class="text-lg md:text-xl font-bold text-neutral-700">课程进度跟踪</h1>
    </div>
  </div>
</header>

<main class="flex-grow container mx-auto px-4 py-8 max-w-md mx-auto">
  <!-- 进度概览 -->
  <section class="bg-white rounded-xl card-shadow p-6 mb-8 fade-in">
    <div class="text-center mb-6">
      <h2 class="text-2xl font-bold text-neutral-700 mb-2">312节课学习计划</h2>
      <p class="text-neutral-500">开始于6月16日，结束于8月16日</p>
    </div>

    <!-- 进度条 -->
    <div class="space-y-6">
      <div>
        <p class="text-sm text-neutral-500 mb-2 flex justify-between">
          <span>计划进度</span>
          <span id="plan-percent">0%</span>
        </p>
        <div class="w-full bg-neutral-200 rounded-full h-2">
          <div id="plan-progress" class="progress-animation bg-primary h-2 rounded-full" style="width: 0%"></div>
        </div>
      </div>

      <div>
        <p class="text-sm text-neutral-500 mb-2 flex justify-between">
          <span>实际进度</span>
          <span id="actual-percent">0%</span>
        </p>
        <div class="w-full bg-neutral-200 rounded-full h-2">
          <div id="actual-progress" class="progress-animation bg-secondary h-2 rounded-full" style="width: 0%"></div>
        </div>
      </div>
    </div>

    <!-- 进度数值 -->
    <div class="grid grid-cols-3 gap-4 mt-8">
      <div class="text-center">
        <p class="text-xs text-neutral-500">总课程</p>
        <p class="text-xl font-bold text-neutral-700">312</p>
      </div>
      <div class="text-center">
        <p class="text-xs text-neutral-500">已完成</p>
        <p id="completed-count" class="text-xl font-bold text-secondary">0</p>
      </div>
      <div class="text-center">
        <p class="text-xs text-neutral-500">剩余</p>
        <p id="remaining-count" class="text-xl font-bold text-neutral-500">312</p>
      </div>
    </div>

    <!-- 进度状态 -->
    <div class="mt-6 text-center">
      <div id="progress-status" class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium">
        <i class="fa fa-info-circle mr-1"></i>
        <span>请更新进度</span>
      </div>
    </div>
  </section>

  <!-- 更新进度区域 -->
  <section class="bg-white rounded-xl card-shadow p-6 fade-in">
    <h3 class="text-lg font-semibold text-neutral-700 mb-4 flex items-center">
      <i class="fa fa-pencil text-primary mr-2"></i> 更新学习进度
    </h3>

    <div class="space-y-4">
      <div>
        <label for="completed-input" class="block text-sm font-medium text-neutral-700 mb-1">已完成课程数</label>
        <div class="relative">
          <input
            type="number"
            id="completed-input"
            class="w-full px-4 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-colors"
            min="0"
            max="312"
            placeholder="输入已完成的课程数"
          >
          <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-400">
            <i class="fa fa-book"></i>
          </div>
        </div>
      </div>

      <button
        id="update-btn"
        class="w-full py-3 px-4 bg-primary text-white font-medium rounded-lg btn-hover flex items-center justify-center"
      >
        <i class="fa fa-refresh mr-2"></i> 更新进度
      </button>
    </div>

    <div id="update-tip" class="mt-3 text-sm text-neutral-500 text-center">
      <i class="fa fa-info-circle text-primary mr-1"></i> 输入已完成课程数，点击按钮更新进度
    </div>

    <div id="save-success" class="mt-3 text-sm text-secondary text-center hidden fade-in">
      <i class="fa fa-check-circle mr-1"></i> 进度已保存
    </div>
  </section>
</main>

<footer class="bg-white border-t border-neutral-200 mt-8 py-4">
  <div class="container mx-auto px-4 text-center text-xs text-neutral-500">
    课程进度跟踪工具 | 数据自动保存在本地浏览器中
  </div>
</footer>

<script>
  // 课程基础数据
  const totalCourses = 312;
  const startDate = new Date('2025-06-16');
  const endDate = new Date('2025-08-16');
  const totalDays = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
  const dailyPlan = totalCourses / totalDays; // 每天计划完成课程数

  // 本地存储键名
  const STORAGE_KEY = 'course_progress_completed';

  // DOM元素
  const completedInput = document.getElementById('completed-input');
  const updateBtn = document.getElementById('update-btn');
  const completedCount = document.getElementById('completed-count');
  const remainingCount = document.getElementById('remaining-count');
  const planProgress = document.getElementById('plan-progress');
  const actualProgress = document.getElementById('actual-progress');
  const planPercent = document.getElementById('plan-percent');
  const actualPercent = document.getElementById('actual-percent');
  const updateTip = document.getElementById('update-tip');
  const saveSuccess = document.getElementById('save-success');
  const progressStatus = document.getElementById('progress-status');

  // 从本地存储获取已完成课程数
  function getSavedCompletedCount() {
    try {
      const savedValue = localStorage.getItem(STORAGE_KEY);
      return savedValue ? parseInt(savedValue) : 0;
    } catch (error) {
      console.error('获取本地存储数据失败:', error);
      return 0;
    }
  }

  // 保存已完成课程数到本地存储
  function saveCompletedCount(completed) {
    try {
      localStorage.setItem(STORAGE_KEY, completed.toString());
      return true;
    } catch (error) {
      console.error('保存本地存储数据失败:', error);
      return false;
    }
  }

  // 获取当前日期的计划完成课程数
  function getPlanCompletedByDate(date) {
    const daysPassed = Math.max(0, Math.ceil((date - startDate) / (1000 * 60 * 60 * 24)));
    // 如果当前日期在开始日期之前，计划完成数为0
    if (daysPassed <= 0) return 0;
    // 如果当前日期在结束日期之后，计划完成数为总课程数
    if (date > endDate) return totalCourses;
    // 正常情况下，计划完成数 = 已过天数 * 每天计划课程数
    return Math.min(Math.floor(daysPassed * dailyPlan), totalCourses);
  }

  // 更新显示函数
  function updateDisplay(actualCompleted) {
    // 获取今天的计划完成数
    const today = new Date();
    today.setHours(0, 0, 0, 0); // 确保比较的是日期，不是时间
    const planCompleted = getPlanCompletedByDate(today);

    // 更新数值
    completedCount.textContent = actualCompleted;
    remainingCount.textContent = totalCourses - actualCompleted;

    // 更新进度条
    const planPercentValue = `${Math.round((planCompleted / totalCourses) * 100)}%`;
    const actualPercentValue = `${Math.round((actualCompleted / totalCourses) * 100)}%`;

    planProgress.style.width = planPercentValue;
    actualProgress.style.width = actualPercentValue;
    planPercent.textContent = planPercentValue;
    actualPercent.textContent = actualPercentValue;

    // 更新进度状态
    let statusClass, statusText, statusIcon;
    if (actualCompleted > planCompleted) {
      statusClass = 'bg-secondary/10 text-secondary';
      statusText = '进度超前';
      statusIcon = 'fa-arrow-up';
    } else if (actualCompleted < planCompleted) {
      statusClass = 'bg-red-100 text-red-600';
      statusText = '进度滞后';
      statusIcon = 'fa-arrow-down';
    } else {
      statusClass = 'bg-neutral-100 text-neutral-600';
      statusText = '按计划进行';
      statusIcon = 'fa-check';
    }

    progressStatus.className = `inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${statusClass}`;
    progressStatus.innerHTML = `<i class="fa ${statusIcon} mr-1"></i><span>${statusText}</span>`;

    // 显示保存成功提示
    saveSuccess.classList.remove('hidden');
    setTimeout(() => {
      saveSuccess.classList.add('hidden');
    }, 2000);
  }

  // 初始化页面
  function initPage() {
    // 获取本地存储的已完成课程数
    const savedCompleted = getSavedCompletedCount();

    // 更新显示
    updateDisplay(savedCompleted);

    // 设置输入框值
    completedInput.value = savedCompleted;

    // 显示提示信息
    updateTip.classList.remove('hidden');
  }

  // 按钮点击事件
  updateBtn.addEventListener('click', function() {
    const inputValue = parseInt(completedInput.value);
    if (isNaN(inputValue) || inputValue < 0 || inputValue > totalCourses) {
      // 输入验证
      completedInput.classList.add('border-red-500');
      setTimeout(() => {
        completedInput.classList.remove('border-red-500');
      }, 1500);
      return;
    }

    // 保存到本地存储
    if (saveCompletedCount(inputValue)) {
      // 更新显示
      updateDisplay(inputValue);
    } else {
      alert('保存失败，请重试');
    }
  });

  // 输入框回车事件
  completedInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      updateBtn.click();
    }
  });

  // 页面加载时初始化
  document.addEventListener('DOMContentLoaded', initPage);
</script>
</body>
</html>